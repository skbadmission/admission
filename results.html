<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å | ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ "‡∏™‡∏∏‡∏Ç‡∏ö‡∏ó"</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@200;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #004e92; --secondary: #FFD700;
            --bg: #eef2f3; --pass: #28a745; --waiting: #fd7e14; --fail: #dc3545;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Kanit', sans-serif; }
        
        body { 
            background-color: var(--bg); 
            animation: fadeIn 1s ease-in-out; 
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        nav {
            background: linear-gradient(to right, #000428, #004e92);
            padding: 15px 5%; color: white; display: flex; align-items: center; justify-content: space-between;
            position: sticky; top: 0; z-index: 1000; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .btn-back { color: white; text-decoration: none; font-size: 0.9rem; background: rgba(255,255,255,0.2); padding: 8px 18px; border-radius: 50px; transition: 0.3s; }
        .btn-back:hover { background: var(--secondary); color: var(--primary); }

        header {
            background: linear-gradient(135deg, #004e92 0%, #000428 100%);
            padding: 50px 5% 80px; text-align: center; color: white;
            border-bottom-left-radius: 50px; border-bottom-right-radius: 50px;
        }
        header h1 { color: var(--secondary); font-size: 2rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }

        .container { max-width: 900px; margin: -40px auto 50px; padding: 0 20px; }
        
        .selection-box {
            background: white; padding: 30px; border-radius: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 25px;
        }
        .selection-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-top: 20px; }
        
        .type-btn {
            padding: 15px; border-radius: 20px; border: 2px solid #eee;
            background: white; cursor: pointer; transition: 0.3s; text-align: center;
            font-size: 0.95rem; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 80px;
        }
        .type-btn.active { border-color: var(--primary); background: #e3f2fd; color: var(--primary); font-weight: 600; }
        .type-btn.disabled { opacity: 0.6; cursor: not-allowed; background: #fafafa; border-style: dashed; }

        .search-area { background: white; padding: 30px; border-radius: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: none; margin-top: 20px; }
        .search-area.show { display: block; animation: slideUp 0.5s ease-out; }
        
        .input-group { position: relative; margin: 20px 0; }
        .input-group input { width: 100%; padding: 15px 50px; border-radius: 50px; border: 2px solid #ddd; outline: none; font-size: 1.1rem; text-align: center; }
        .input-group i { position: absolute; left: 20px; top: 50%; transform: translateY(-50%); color: #888; }

        .btn-check { width: 100%; padding: 15px; border-radius: 50px; border: none; background: var(--primary); color: white; font-size: 1.1rem; cursor: pointer; font-weight: 600; transition: 0.3s; }
        .btn-check:hover { background: #003366; transform: translateY(-2px); }

        .result-display { margin-top: 30px; display: none; }
        .result-card { background: white; padding: 40px; border-radius: 30px; text-align: center; box-shadow: 0 15px 35px rgba(0,0,0,0.1); animation: slideUp 0.5s ease-out; }
        
        .btn-download { display: inline-flex; align-items: center; gap: 10px; background: var(--primary); color: white; padding: 12px 25px; border-radius: 50px; text-decoration: none; margin-top: 20px; transition: 0.3s; font-weight: 600; }
        .btn-download:hover { background: var(--pass); transform: scale(1.05); }

        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        footer { text-align: center; padding: 40px; color: #888; }
    </style>
</head>
<body>

<nav>
    <a href="index.html" class="btn-back"><i class="fas fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
    <div class="nav-logo">‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ú‡∏•‡∏™‡∏≠‡∏ö 2569</div>
</nav>

<header>
    <h1>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
    <p>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ "‡∏™‡∏∏‡∏Ç‡∏ö‡∏ó" | Chonburi Sukbot School</p>
</header>

<div class="container">
    <div class="selection-box">
        <h3 style="text-align:center;"><i class="fas fa-list-ul"></i> 1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</h3>
        <div class="selection-grid" id="typeGrid">
            <div class="type-btn" onclick="selectType('quota', this)" id="btn-quota">‡∏£‡∏≠‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏î‡∏¥‡∏°</div>
            <div class="type-btn" onclick="selectType('gifted', this)" id="btn-gifted">‡∏£‡∏≠‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© (Gifted)</div>
            <div class="type-btn" onclick="selectType('special', this)" id="btn-special">‡∏£‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏©</div>
            <div class="type-btn" onclick="selectType('general', this)" id="btn-general">‡∏£‡∏≠‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ / EIS</div>
        </div>
    </div>

    <div class="search-area" id="searchArea">
        <h3 id="selectedTitle" style="text-align:center; color: var(--primary);">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</h3>
        <p style="text-align:center; color: #666; font-size: 0.8rem; margin: 10px 0;">‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</p>
        <div class="input-group">
            <i class="fas fa-search"></i>
            <input type="text" id="idInput" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: 12001">
        </div>
        <button class="btn-check" id="searchBtn" onclick="fetchResult()">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</button>
    </div>

    <div class="result-display" id="resultDisplay">
        <div class="result-card" id="resultCard"></div>
    </div>
</div>

<footer>
    <p>&copy; 2026 Chonburi Sukbot School | Smart Admission Results</p>
</footer>

<script>
    let currentType = '';
    
    // üîó ‡∏£‡∏ß‡∏°‡∏•‡∏¥‡∏á‡∏Å‡πå Google Sheets ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡∏Ç gid ‡πÅ‡∏¢‡∏Å Tab ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πâ‡∏≤‡∏ô‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Ñ‡∏£‡∏±‡∏ö
    const baseSheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vToBBpirBk8Z5hs31ggXMpdaNQdm7lQaQxlwKjegeDsgHufji1SrVW2fs4XMIiyCqK3JGVY7qfHydTY/pub?output=csv";

    const sheetLinks = {
        'quota':   baseSheetUrl + "&gid=0",
        'gifted':  baseSheetUrl + "&gid=199296400",
        'special': baseSheetUrl + "&gid=788651695",
        'general': baseSheetUrl + "&gid=1326972360"
    };

    function selectType(type, element) {
        // ‡∏ñ‡πâ‡∏≤‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ú‡∏• ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á Pop-up ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏£‡∏±‡∏ö
        if (element.classList.contains('disabled')) {
            alert("‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ú‡∏•‡∏™‡∏≠‡∏ö‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö");
            return;
        }
        
        currentType = type;
        document.querySelectorAll('.type-btn').forEach(btn => btn.classList.remove('active'));
        element.classList.add('active');
        
        document.getElementById('searchArea').classList.add('show');
        document.getElementById('selectedTitle').innerText = "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠: " + element.innerText;
        document.getElementById('resultDisplay').style.display = 'none';
        document.getElementById('idInput').value = '';
    }

    async function fetchResult() {
        const id = document.getElementById('idInput').value.trim();
        const display = document.getElementById('resultDisplay');
        const card = document.getElementById('resultCard');
        const btn = document.getElementById('searchBtn');
        
        if(!id) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏£‡∏±‡∏ö"); return; }
        
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
        btn.disabled = true;

        try {
            const response = await fetch(sheetLinks[currentType]);
            const data = await response.text();
            
            // ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV ‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
            const rows = data.split('\n').map(row => row.split(','));
            
            // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ID ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏£‡∏Å (ID ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πä‡∏∞)
            const result = rows.find(row => row[0] && row[0].trim() === id);

            display.style.display = 'block';
            
            if (result) {
                const [studentId, name, status, rank, docLink] = result;
                
                // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ô Sheet
                let color = status.includes("‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á") ? "#28a745" : (status.includes("‡∏™‡∏≥‡∏£‡∏≠‡∏á") ? "#fd7e14" : "#dc3545");
                let icon = status.includes("‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á") ? "fa-check-circle" : (status.includes("‡∏™‡∏≥‡∏£‡∏≠‡∏á") ? "fa-clock" : "fa-times-circle");

                card.innerHTML = `
                    <i class="fas ${icon}" style="font-size: 5rem; color: ${color};"></i>
                    <h2 style="margin-top:20px; color: ${color}; font-size: 1.8rem;">${status}</h2>
                    <div style="text-align: left; background: #f9f9f9; padding: 25px; border-radius: 20px; margin: 25px 0; border: 1px solid #eee;">
                        <p style="margin-bottom:10px; font-size: 1.1rem;"><strong>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</strong> ${name}</p>
                        <p style="margin-bottom:10px; color: #555;"><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> ${currentType.toUpperCase()}</p>
                        <p style="color: #555;"><strong>‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:</strong> ${rank}</p>
                    </div>
                    ${docLink && docLink.trim() !== "" ? 
                        `<a href="${docLink.trim()}" class="btn-download" target="_blank"><i class="fas fa-file-download"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß</a>` : 
                        "<p style='color:#888; font-size:0.85rem;'>*‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Å‡∏≤‡∏£</p>"
                    }
                `;
            } else {
                card.innerHTML = `
                    <i class="fas fa-user-times" style="font-size: 4rem; color: #ccc;"></i>
                    <h3 style="margin-top:20px; color: #888;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏´‡∏±‡∏™ "${id}"</h3>
                    <p style="color:#999; margin-top:10px;">‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏´‡∏±‡∏™ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p>
                `;
            }
        } catch (error) {
            alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï");
        } finally {
            btn.innerHTML = '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö';
            btn.disabled = false;
        }
    }

    // üïí ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ú‡∏• (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö)
    window.onload = function() {
        const now = new Date().getTime();
        
        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ú‡∏•‡∏ï‡∏≤‡∏°‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏à‡∏£‡∏¥‡∏á
        const schedules = {
            'quota':   new Date("January 21, 2026 08:30:00").getTime(),
            'gifted':  new Date("February 27, 2026 08:30:00").getTime(),
            'special': new Date("March 26, 2026 08:30:00").getTime(),
            'general': new Date("April 1, 2026 08:30:00").getTime()
        };

        for (let type in schedules) {
            const btn = document.getElementById(`btn-${type}`);
            if (now < schedules[type]) {
                btn.classList.add('disabled');
                // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ú‡∏•"
                btn.innerHTML = btn.innerText + '<br><span style="font-size:0.75rem; color:#dc3545; font-weight:normal;">(‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ú‡∏•)</span>';
            }
        }
    };
</script>
</body>
</html>